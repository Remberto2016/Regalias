{% extends 'base.html' %}

{% block title %}
Nuestros Clientes
{% endblock %}
{% block content %}
<div class="col-md-12 col-sm-12 col-xs-12">
  <div class="x_panel">
    <div class="x_title">
      <h2 class="app">Lista de clientes </h2>
      <ul class="nav navbar-right panel_toolbox">
        <li><a href="{% url 'cliente-pdf' %}" class="btn btn-danger " target="_blank" data-toggle="tooltip" title="Psar a PDF!">
            <strong style="color:black;">PDF <i class="fa fa-file-pdf-o"></i></strong>
        </a></li>
        <li><a href="{% url 'cliente-new' %}" type="button" href="" class="btn btn-success" data-toggle="tooltip" title="Nuevo Cliente!"><span class="glyphicon glyphicon-plus" ></span></a></li>
        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
        </li>
        <li><a class="close-link" href=""><i class="fa fa-close"></i></a>
        </li>
    </ul>
    <div class="clearfix"></div>
</div>
<div class="x_content">
  <p class="text-muted font-13 m-b-30">
    Este es una tabla donde contiene los datos de los clientes registrados.
</p>
<div class="row col-md-12" id="imprimir">
    <table class="table striped hovered border bordered">
        <thead>
            <tr>
                <th width="30px">#</th>
                <th>NIT</th>
                <th>Razon Social</th>
                <th>Telefono</th>
                <th>Direccion</th>
                <th>Pais/Ciudad</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for cliente in clientes %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ cliente.nit }}</td>
                <td>{{ cliente.razon }}</td>
                <td>{{ cliente.telefono }}</td>
                <td>{{ cliente.direccion }}</td>
                <td>{{ cliente.ciudad.pais}}/{{ cliente.ciudad }}</td>
                <td>
                    <a href="{% url 'cliente-update' cliente.id %}" class="btn btn-warning btn-xs" title="Editar Cliente">
                        <i class="fa fa-pencil-square"></i>
                    </a>
                    <button type="button" class="btn btn-primary btn-xs openmodal" data-toggle="modal" data-target=".bs-example-modal-lg{{ cliente.id }}" title="Detalle Cliente">
                        <i class="fa fa-info-circle"></i>
                    </button>
                    <a href="{% url 'cliente-baja' cliente.id %}" class="btn btn-danger btn-xs" title="Baja Cliente">
                        <i class="fa fa-times-circle"></i>
                    </a>
                    <div class="modal fade bs-example-modal-lg{{ cliente.id }}" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-md" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title app" align="center">{{cliente.razon}}</h4>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-9" >
                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th width="10%"></th>
                                                        <th width="40%"></th>
                                                        <th width="50%"></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td></td>
                                                        <td><h4> <strong> Nit / C.I.: </strong></h4>
                                                            <h4> <strong> Nombre: </strong></h4>
                                                            <h4> <strong> Telefono: </strong> </h4>
                                                            <h4> <strong> Direcc√≠on: </strong> </h4>
                                                            <h4> <strong> Email: </strong> </h4>
                                                            <h4> <strong> Pais / Ciudad: </strong> </h4>
                                                        </td>
                                                        <td>
                                                            <h4> {{ cliente.nit }}</h4>
                                                            <h4> {{ cliente.razon }}</h4>
                                                            <h4> {{ cliente.telefono }}</h4>
                                                            <h4> {{ cliente.direccion }}</h4>
                                                            <h4> {{ cliente.email }}</h4>
                                                            <h4> {{ cliente.ciudad.pais }} / {{ cliente.ciudad }}</h4>
                                                        </td>
                                                    </tr>

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="modal-footer" >
                                        <div class="" align="center">
                                            <button  style="" type="submit" class="btn btn-success btn-default" data-dismiss="modal">Aceptar</button></div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>
</div>
</div>
{% endblock %}

{% block js %}
<script>
function pruebaDivAPdf() {
    var pdf = new jsPDF('p', 'pt', 'letter');
    source = $('#imprimir')[0];

    specialElementHandlers = {
        '#bypassme': function (element, renderer) {
            return true
        }
    };
    margins = {
        top: 80,
        bottom: 60,
        left: 40,
        width: 522
    };

    pdf.fromHTML(
        source,
        margins.left, // x coord
        margins.top, { // y coord
            'width': margins.width,
            'elementHandlers': specialElementHandlers
        },

        function (dispose) {
            pdf.save('Prueba.pdf');
        }, margins
        );
}
</script>
{% endblock %}